---
import { Image } from "astro:assets";
import { fetchFromAPI, STRAPI_BASE_URL } from "../lib/conection"; // aca se importa la función fetchFromAPI

interface Noticia { // datos de las noticias
    documentId: string;
    titulo: string;
    descripcion: string;
    fecha: string;
    imagen: {
        url: string;
    };
    categoria: string;
    destacado: boolean;
}

const data = await fetchFromAPI('technology'); // aca llamamos los datos del single type: technology
const noticias: Noticia[] = await fetchFromAPI('noticias'); // aca llamamos los datos del Collection Type: noticias

const tecnologia = noticias.filter((item)=>item.categoria === 'tecnologia'); // aca se filtran las noticias de tecnologia
---
<!-- Hero -->
<section class="relative w-full h-[400px]">
    <Image
        src={`${STRAPI_BASE_URL}${data.imagen.url}` || ''}
        alt={data.titulo}
        class="w-full h-full object-cover"
        inferSize={true}
    />
    <div class="absolute inset-0 bg-black/60 flex flex-col justify-center items-center text-center p-6">
        <h1 class="text-white text-4xl md:text-6xl font-bold">{data.titulo}</h1>
        <h2 class="text-gray-200 text-xl md:text-3xl mt-3">{data.descripcion}</h2>
    </div>
</section>

<!-- Información de Tecnologia -->
<section class="bg-linear-to-r from-blue-600 mx-auto py-16 px-6 grid md:grid-cols-2 gap-10">
    <!-- ¿Que es la tecnologia? -->
    <div class="bg-white shadow-lg rounded-xl overflow-hidden">
        <Image
            src={`${STRAPI_BASE_URL}${data.imagen2.url}` || ''}
            alt={data.titulo}
            class="w-full h-56 object-cover"
            inferSize={true}
        />
        <div class="p-6">
            <h1 class="text-2xl font-bold mb-2">{data.titulo2}</h1>
            <p class="text-gray-600">{data.descripcion2}</p>
        </div>
    </div>
    <!-- ¿Que es un Software? -->
    <div class="bg-white shadow-lg rounded-xl overflow-hidden">
        <Image
            src={`${STRAPI_BASE_URL}${data.imagen3.url}` || ''}
            alt={data.titulo}
            class="w-full h-56 object-cover"
            inferSize={true}
        />
        <div class="p-6">
            <h1 class="text-2xl font-bold mb-2">{data.titulo3}</h1>
            <p class="text-gray-600">{data.descripcion3}</p>
        </div>
    </div>
</section>

<!-- Noticias de Tecnologia -->
<section class="container mx-auto px-4 py-16 bg-gray-100">
    <div class="justify-between items-center text-center mb-8 pb-8 border-b-2 border-gray-800">
        <h2 class="text-4xl font-bold">{data.titulo4}</h2>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {tecnologia.map((item)=> ( // aqui se muestran las noticias de tecnologia
            <article class="bg-white text-white rounded-lg overflow-hidden shadow-md transition duration-300 hover:shadow-lg transform hover:-translate-y-1.5">
                <div class="relative">
                    <Image 
                        src={`${STRAPI_BASE_URL}${item.imagen.url}` || ''}
                        alt={item.titulo}
                        class="w-full h-48 object-cover"
                        inferSize={true}
                    />
                </div>
                <div class="p-6">
                    <div class="flex items-center text-sm text-gray-500 mb-3">
                        <span>{item.fecha}</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-3">{item.titulo}</h3>
                    <p class="text-gray-600 mb-4 line-clamp-3">{item.descripcion.slice(0, 130)}...</p>
                    <a href={`/noticias/${item.documentId}`} class="text-blue-400 font-medium hover:underline inline-flex items-center">
                        Leer más >
                    </a>
                </div>
            </article>
        ))}
    </div>
</section>

<!-- Suscripción las noticias -->
<section class="py-16 bg-linear-to-r from-blue-400 to-gray-300">
    <div class="container mx-auto px-4 text-center">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">{data.titulo5}</h2>
        <p class="text-xl max-w-3xl mx-auto mb-8">{data.descripcion4}</p>

        <form action="https://formspree.io/f/mgvgzwez" method="POST" class="flex flex-col md:flex-row gap-4 justify-center text-white">
            <input type="email" name="email" placeholder="Correo Electronico" class="border border-white rounded-lg p-3 w-full md:w-96 focus:outline-none focus:ring-2 focus:ring-white" />
            <button type="submit" class="bg-white text-black font-medium px-6 py-3 rounded-lg hover:bg-gray-100 transition duration-300">{data.boton}</button>
        </form>
    </div>
</section>